// jquery.divider.js
// @weblinc, @jsantell (c) 2012
// Dependencies: jQuery UI (draggable)

(function(a){a.fn.divider=function(b){var c=a.extend({},a.fn.divider.defaults,b),d=c.direction==="vertical";return this.css("position","relative"),this.each(function(){function l(c,d){var e=a(this),h=e.data("divider-index"),i=d.position[f],j=n(a(this),-1),k=n(a(this),1),l=j?parseInt(j.css(f),10)+j[g]():null,o=k?parseInt(k.css(f),10)-k[g]():null;j&&i<l&&(i=l),k&&i>o&&(i=o);var p=b[g]()-e[g]();i<0&&(i=0),i>p&&(i=p),d.position[f]=i,m(h,i)}function m(b,c){h.filter(function(){return a(this).data("divider-index")===b}).css(d?"width":"height",c)}function n(a,b){var c=a.data("divider-index"),d=e.slice(c+b,c+b+1);return d.length?d:null}var b=a(this),e=a(),f=d?"left":"top",g=d?"width":"height",h=b.find(c.panels).css({position:"absolute",top:"0px",left:"0px"}),i=c.controller instanceof jQuery?c.controller:a("<div />",{"class":c.controller});c.handle&&(i=i.append(c.handle instanceof jQuery?c.handle:a("<div />",{"class":c.handle}))),h.each(function(b){~~a(this).css("z-index")<h.length-b&&a(this).css("z-index",h.length-b).data("divider-index",b)});for(var j=0,k=h.length;j<k-1;j++)e=e.add(i.clone().css(f,c.position.length===k-1?c.position[j]:b[g]()/k*(j+1)).appendTo(b).data("divider-index",e.length).data("divider-orig-position",e.length));e.css({zIndex:~~h.first().css("z-index")+1,position:"absolute"}).draggable({axis:d?"x":"y",containment:b,cursor:"pointer",drag:l}),e.each(function(b,c){var d=a(this),e=d.data("divider-index"),g=d.css(f);m(e,g)})})},a.fn.divider.defaults={panels:".panels",controller:"controller",direction:"vertical",position:[],handle:!1}})(jQuery)